<!-- app.component.html -->
<div class="app-container">
  <app-header></app-header>

  <div class="container">
    <h2 class="title">Gestion des Logements</h2>

    <div class="content">
      <!-- Liste des annonces √† gauche -->
      <div class="annonces-section">
        <div class="section-header">
          <h3>
            <i class="icon-house">üè†</i>
            Liste des Annonces
          </h3>
          <div class="annonces-count" *ngIf="annonces.length > 0">
            {{ annonces.length }} logement{{ annonces.length > 1 ? 's' : '' }}
          </div>
        </div>

        <div class="annonces-list">
          @for (annonce of paginatedAnnonces; track annonce._id) {
            <div class="annonce-card">
              <div class="card-glow"></div>
              <div class="annonce-header">
                <h4>{{ annonce.titre }}</h4>
                <div class="card-badge">Nouveau</div>
              </div>
              <p class="annonce-description">{{ annonce.description }}</p>
              <div class="annonce-footer">
                <div class="annonce-meta">
                  <small class="annonce-date">
                    <i class="icon-calendar">üìÖ</i>
                    Cr√©√© le : {{ annonce.dateCreation | date:'dd/MM/yyyy √† HH:mm' }}
                  </small>
                  <div class="annonce-actions">
                    <button class="btn-action" title="Voir les d√©tails">
                      <i class="icon-eye">üëÅÔ∏è</i>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          }

          @if (annonces.length === 0) {
            <div class="empty-state">
              <div class="empty-icon">
                <i class="icon-home">üè†</i>
              </div>
              <p>Aucun logement disponible</p>
              <small>Commencez par ajouter votre premier logement</small>
            </div>
          }
        </div>

        <!-- Pagination -->
        @if (annonces.length > itemsPerPage) {
          <div class="pagination-section">
            <div class="pagination">
              <button class="pagination-btn"
                      (click)="goToPage(currentPage - 1)"
                      [disabled]="currentPage === 1">
                <i class="icon-arrow">‚Üê</i>
                Pr√©c√©dent
              </button>

              <div class="pagination-numbers">
                @for (page of getPageNumbers(); track page) {
                  <button class="pagination-number"
                          [class.active]="page === currentPage"
                          (click)="goToPage(page)">
                    {{ page }}
                  </button>
                }
              </div>

              <button class="pagination-btn"
                      (click)="goToPage(currentPage + 1)"
                      [disabled]="currentPage === totalPages">
                Suivant
                <i class="icon-arrow">‚Üí</i>
              </button>
            </div>

            <div class="pagination-info">
              Page {{ currentPage }} sur {{ totalPages }}
              <span class="pagination-total">({{ annonces.length }} logement{{ annonces.length > 1 ? 's' : '' }})</span>
            </div>
          </div>
        }
      </div>

      <!-- Formulaire d'ajout √† droite -->
      <div class="form-section">
        <div class="form-header">
          <h3>
            <i class="icon-add">‚ú®</i>
            Ajouter une nouvelle annonce
          </h3>
          <div class="form-steps">√âtape 1</div>
        </div>

        <form (ngSubmit)="onSubmit(annonceForm)" #annonceForm="ngForm" class="annonce-form">
          <div class="form-group">
            <label for="titre" class="form-label">
              <i class="icon-title">üìù</i>
              Titre *
            </label>
            <input type="text" id="titre" name="titre" class="form-control"
                   [(ngModel)]="newAnnonce.titre"
                   #titre="ngModel"
                   required
                   placeholder="Ex: Appartement 3 pi√®ces centre-ville"
                   [class.invalid]="titre.invalid && titre.touched">
            @if (titre.invalid && titre.touched) {
              <div class="error-message">
                <i class="icon-error">‚ö†Ô∏è</i>
                Le titre est requis
              </div>
            }
          </div>

          <div class="form-group">
            <label for="description" class="form-label">
              <i class="icon-description">üìÑ</i>
              Description *
            </label>
            <textarea id="description" name="description" class="form-control"
                      [(ngModel)]="newAnnonce.description"
                      #description="ngModel"
                      required
                      rows="6"
                      placeholder="D√©crivez votre logement en d√©tail..."
                      [class.invalid]="description.invalid && description.touched"></textarea>
            @if (description.invalid && description.touched) {
              <div class="error-message">
                <i class="icon-error">‚ö†Ô∏è</i>
                La description est requise
              </div>
            }
          </div>

          <button type="submit" class="btn-primary" [disabled]="!annonceForm.valid">
            <span class="btn-icon">
              <i class="icon-plus">+</i>
            </span>
            Ajouter le logement
            <div class="btn-shine"></div>
          </button>
        </form>
      </div>
    </div>
  </div>

  <app-footer></app-footer>
</div>
