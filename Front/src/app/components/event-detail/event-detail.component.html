<div class="event-detail-container">
  <!-- Navigation -->
  <nav class="breadcrumb-nav">
    <a routerLink="/events" class="breadcrumb-link">
      <i class="breadcrumb-icon">←</i>
      Retour aux événements
    </a>
  </nav>

  <!-- État de chargement -->
  @if (!event) {
    <div class="loading-state">
      <div class="spinner-container">
        <div class="spinner"></div>
      </div>
      <h3>Chargement de l'événement</h3>
      <p>Préparation des détails...</p>
    </div>
  }

  <!-- Contenu principal de l'événement -->
  @if (event) {
    <div class="event-layout">
      <!-- Colonne principale -->
      <div class="event-main">
        <!-- En-tête de l'événement -->
        <header class="event-header">


          <h1 class="event-title">{{ event.title }}</h1>
        @if (event.lienImage) {
    <img
      [src]="'http://localhost:9000' + event.lienImage"
      alt="{{ event.title }}"
      class="event-image" />
  }

          <div class="event-meta-grid">
            <div class="meta-item">
              <div class="meta-icon">📅</div>
              <div class="meta-content">
                <span class="meta-label">Date de début</span>
                <span class="meta-value">{{ event.startDate | date:'fullDate' }}</span>
                <span class="meta-subvalue">{{ event.startDate | date:'HH:mm' }}</span>
              </div>
            </div>

            <div class="meta-item">
              <div class="meta-icon">🏁</div>
              <div class="meta-content">
                <span class="meta-label">Date de fin</span>
                <span class="meta-value">{{ event.endDate | date:'fullDate' }}</span>
                <span class="meta-subvalue">{{ event.endDate | date:'HH:mm' }}</span>
              </div>
            </div>

            <div class="meta-item">
              <div class="meta-icon">📍</div>
              <div class="meta-content">
                <span class="meta-label">Lieu  </span>
                <span class="meta-value">{{    event.localisation }}</span>

              </div>
            </div>

            <div class="meta-item">
              <div class="meta-icon">👥</div>
              <div class="meta-content">
                <span class="meta-label">Participants</span>
                <span class="meta-value">{{ event.attendees?.length || 0 }} / {{ event.capacity || '∞' }}</span>
                <div class="capacity-progress">
                  <div class="progress-bar">

                  </div>

                </div>
              </div>
            </div>
          </div>
        </header>

        <!-- Description détaillée -->
        <section class="event-description-section">
          <h2 class="section-title">À propos de cet événement</h2>
          <div class="description-content">
            <p>{{ event.description }}</p>
            <p>{{event.localisation}}</p>
            <p>{{event.endDate}}</p>
            <p>{{event.startDate}}</p>
          </div>

          <!-- Tags et catégories -->

        </section>

        <!-- Section participants -->
        <section class="participants-section">
          <div class="section-header">
            <h2 class="section-title">Participants ({{ event.attendees?.length || 0 }})</h2>
            <div class="section-actions">

            </div>
          </div>

          @if (event.attendees && event.attendees.length > 0) {
            <div class="attendees-grid">
              @for (attendee of event.attendees; track attendee.studentId) {
                <div class="attendee-card">
                  <div class="attendee-avatar">

                  </div>

                  <div class="attendee-actions">

                  </div>
                </div>
              }
            </div>
          } @else {
            <div class="empty-attendees">
              <i class="empty-icon">👥</i>
              <h3>Aucun participant pour l'instant</h3>
              <p>Soyez le premier à vous inscrire !</p>
            </div>
          }
        </section>
      </div>

      <!-- Sidebar -->
      <aside class="event-sidebar">
        <!-- Carte d'inscription -->
        <!-- Carte d'inscription -->
<!-- Carte d'inscription -->
<div class="registration-card">
  <div class="card-header">
    <h3 class="card-title">Rejoindre l'événement</h3>
  </div>

  @if (alreadyRegistered) {
    <div class="already-registered">
      <p class="info-text">✅ Vous êtes déjà inscrit à cet événement.</p>
    </div>
  } @else {
    <form #registrationForm="ngForm" class="registration-form" (ngSubmit)="register()" novalidate>

      <!-- Champ Email -->
      <div class="form-group">
        <label for="studentEmail" class="form-label">
          <i class="label-icon">📧</i>
          Email
        </label>
        <input
          id="studentEmail"
          type="email"
          name="email"
          [(ngModel)]="student.studentId"
          #emailCtrl="ngModel"
          required
          email
          placeholder="exemple@domaine.com"
          class="form-input"
        />

        <!-- Erreurs de validation -->
        @if (emailCtrl.invalid && (emailCtrl.dirty || emailCtrl.touched)) {
          <div class="error-message">
            @if (emailCtrl.errors?.['required']) {
              <p>L'email est obligatoire.</p>
            }
            @if (emailCtrl.errors?.['email']) {
              <p>Format d'email invalide</p>
            }
          </div>
        }
      </div>

      <!-- Champ Nom -->
      <div class="form-group">
        <label for="studentName" class="form-label">
          <i class="label-icon">👤</i>
          Nom complet
        </label>
        <input
          id="studentName"
          type="text"
          name="name"
          [(ngModel)]="student.name"
          #nameCtrl="ngModel"
          required
          placeholder="Votre nom et prénom"
          class="form-input"
        />

        @if (nameCtrl.invalid && (nameCtrl.dirty || nameCtrl.touched)) {
          <div class="error-message">
            <p>Le nom complet est obligatoire.</p>
          </div>
        }
      </div>

      <!-- Bouton d'inscription -->
      <button
        type="submit"
        class="register-btn"
        [disabled]="registrationForm.invalid"
      >
        S'inscrire
      </button>

      <div class="form-footer">
        <p class="form-note">
          <i class="note-icon">ℹ️</i>
          Vous recevrez une confirmation par email
        </p>
      </div>
    </form>
  }
</div>


        <!-- ************* -->
        <!-- Actions rapides -->
        <!-- <div class="action-card">
          <h3 class="card-title">Partager</h3>
          <div class="action-buttons">
            <button class="social-btn whatsapp" (click)="shareOnWhatsApp()">
              <i class="social-icon">💚</i>
              WhatsApp
            </button>
            <button class="social-btn linkedin" (click)="shareOnLinkedIn()">
              <i class="social-icon">💼</i>
              LinkedIn
            </button>
            <button class="social-btn twitter" (click)="shareOnTwitter()">
              <i class="social-icon">🐦</i>
              Twitter
            </button>
            <button class="social-btn copy" (click)="copyEventLink()">
              <i class="social-icon">📋</i>
              Copier le lien
            </button>
          </div>
        </div> -->

        <!-- Statistiques -->
        <!-- <div class="stats-card">
          <h3 class="card-title">Statistiques</h3>
          <div class="stats-list">
            <div class="stat-item">
              <span class="stat-label">Taux d'inscription</span>
              <span class="stat-value">{{ getAttendancePercentage(event) }}%</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">Places restantes</span>
              <span class="stat-value">{{ getRemainingSpots(event) }}</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">Date de création</span>
              <span class="stat-value">{{ event.createdAt | date:'shortDate' }}</span>
            </div>
          </div>
        </div> -->
      </aside>
    </div>

    <!-- Messages de statut -->
    @if (successMessage) {
      <div class="status-message success">
        <div class="message-content">
          <i class="message-icon">🎉</i>
          <div class="message-text">
            <h4>Inscription réussie !</h4>
            <p>{{ successMessage }}</p>
          </div>
        </div>
        <button class="message-close" (click)="successMessage = ''">×</button>
      </div>
    }

    @if (errorMessage) {
      <div class="status-message error">
        <div class="message-content">
          <i class="message-icon">⚠️</i>
          <div class="message-text">
            <h4>Erreur d'inscription</h4>
            <p>{{ errorMessage }}</p>
          </div>
        </div>
        <button class="message-close" (click)="errorMessage = ''">×</button>
      </div>
    }

    <!-- Événements similaires -->

  }
</div>
