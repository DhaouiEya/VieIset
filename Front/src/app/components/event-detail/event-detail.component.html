
<div class="event-detail-container">
  <!-- Navigation -->
  <nav class="breadcrumb-nav" aria-label="Fil d'Ariane">
    <a routerLink="/events" class="breadcrumb-link">
      <i class="breadcrumb-icon fas fa-arrow-left"></i>
      Retour aux événements
    </a>
  </nav>

  @if (!event) {
    <div class="loading-state" aria-live="polite" aria-label="Chargement en cours">
      <div class="spinner-container">
        <div class="spinner" role="status">
          <span class="sr-only">Chargement...</span>
        </div>
      </div>
      <h3>Chargement de l'événement</h3>
      <p>Préparation des détails...</p>
    </div>
  }

  <!-- Contenu principal -->
  @if (event) {
    <div class="event-layout">
      <!-- Colonne principale -->
      <main class="event-main">
        <header class="event-header">
          <h1 class="event-title">{{ event.title }}</h1>

          @if (event.lienImage) {
            <figure class="event-image-container">
              <img
                [src]="'http://localhost:9000' + event.lienImage"
                alt="{{ event.title }}"
                class="event-image"
                loading="lazy"
              />
            </figure>
          }

          <div class="event-meta-grid">
            <div class="meta-item">
              <div class="meta-icon">
                <i class="fas fa-calendar-alt"></i>
              </div>
              <div class="meta-content">
                <span class="meta-label">Date de début</span>
                <span class="meta-value">{{ event.startDate | date:'fullDate' }}</span>
                <span class="meta-subvalue">{{ event.startDate | date:'HH:mm' }}</span>
              </div>
            </div>

            <div class="meta-item">
              <div class="meta-icon">
                <i class="fas fa-flag-checkered"></i>
              </div>
              <div class="meta-content">
                <span class="meta-label">Date de fin</span>
                <span class="meta-value">{{ event.endDate | date:'fullDate' }}</span>
                <span class="meta-subvalue">{{ event.endDate | date:'HH:mm' }}</span>
              </div>
            </div>

            <div class="meta-item">
              <div class="meta-icon">
                <i class="fas fa-map-marker-alt"></i>
              </div>
              <div class="meta-content">
                <span class="meta-label">Lieu</span>
                <span class="meta-value">{{ event.localisation }}</span>
              </div>
            </div>

            <div class="meta-item">
              <div class="meta-icon">
                <i class="fas fa-users"></i>
              </div>
              <div class="meta-content">
                <span class="meta-label">Participants</span>
                <span class="meta-value">{{ participantCount }} / {{ event.capacity}}</span>
                @if (event.capacity && event.attendees?.length) {
                  <div class="capacity-progress">
                    <div class="progress-bar">

                    </div>
                  </div>
                }
              </div>
            </div>
          </div>
        </header>

        <!-- Description -->
        <section class="event-description-section" aria-labelledby="description-title">
          <h2 id="description-title" class="section-title">À propos de cet événement</h2>
          <div class="description-content">
            <p>{{ event.description }}</p>
          </div>
        </section>

      </main>
      <!-- Sidebar -->
      <aside class="event-sidebar" aria-labelledby="registration-title">
        <div class="registration-card">
          <div class="card-header">
            <h3 id="registration-title" class="card-title">Rejoindre l'événement</h3>
          </div>

          <div class="card-body">
            @if (alreadyRegistered) {
              <div class="already-registered">
                <i class="fas fa-check-circle"></i>
                <p class="info-text">Vous êtes déjà inscrit à cet événement.</p>
              </div>
            } @else {
               <!-- (click)="inscrire()" -->
              <div class="registration-button">
                <button
                
                  class="btn-inscrire"
                  [disabled]="alreadyRegistered "
                  aria-label="S'inscrire à cet événement">
                  S'inscrire
                </button>
              </div>
            }

            @if (event.capacity && event.attendees && event.attendees.length >= event.capacity) {
              <div class="capacity-warning">
                <i class="fas fa-exclamation-triangle"></i>
                <p>Capacité maximale atteinte</p>
              </div>
            }
          </div>
        </div>
      </aside>
    </div>

    <!-- Messages -->
    @if (successMessage) {
      <div class="status-message success" role="alert" aria-live="assertive">
        <div class="message-content">
          <i class="message-icon fas fa-check-circle"></i>
          <div class="message-text">
            <h4>Inscription réussie !</h4>
            <p>{{ successMessage }}</p>
          </div>
        </div>
        <button class="message-close" (click)="successMessage = ''" aria-label="Fermer le message">×</button>
      </div>
    }

    @if (errorMessage) {
      <div class="status-message error" role="alert" aria-live="assertive">
        <div class="message-content">
          <i class="message-icon fas fa-exclamation-circle"></i>
          <div class="message-text">
            <h4>Erreur d'inscription</h4>
            <p>{{ errorMessage }}</p>
          </div>
        </div>
        <button class="message-close" (click)="errorMessage = ''" aria-label="Fermer le message">×</button>
      </div>
    }
  }
</div>

