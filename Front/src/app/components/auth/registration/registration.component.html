<div class="container-fluid vh-100">
  <div class="row h-100">

    <!-- Image à gauche -->
    <div class="col-md-7 d-none d-md-block p-0">
      <img src="bg1.jpg" alt="Image d'inscription" class="img-fluid h-100 w-100 object-fit-cover">
    </div>

    <!-- Formulaire à droite -->
    <div class="col-md-5 d-flex align-items-center justify-content-center">
      <div>
        <form class="form w-100" novalidate id="kt_login_signup_form" [formGroup]="registrationForm"
          (ngSubmit)="submit()">

          <!-- Titre -->
          <div class="text-center mb-4">
            <h1 class="text-danger fw-bolder mb-2">Bienvenue à ISET Vie Étudiant</h1>
            <div class="text-gray-500 fw-semibold fs-6">Entrez vos informations pour créer votre compte</div>
          </div>

          <!-- Connexion Google -->
          <div class="row g-3 mb-3">
            <div class="col-12">
              <a id="googleLoginButton" (click)="triggerGoogleSignIn()"
                class="btn btn-flex btn-outline btn-text-gray-700 btn-active-color-primary bg-state-light flex-center text-nowrap w-100">
                <img alt="Logo Google" src="google-icon.svg" class="h-15px me-3" />
                Se connecter avec Google
              </a>
            </div>
          </div>

          <!-- Séparateur -->
          <div class="separator separator-content my-4"></div>

          <!-- Alertes d'erreur -->
          <!-- Alertes d'erreur -->
          <ng-container *ngIf="hasError">
            <div class="mb-3 alert alert-danger d-flex align-items-start" role="alert">
              <i class="bi bi-exclamation-circle-fill me-2 fs-4"></i>
              <div class="d-flex flex-column">

                <span><strong>Erreur :</strong>
                  {{ message }}</span>
              </div>
            </div>
          </ng-container>


          <!-- Champs du formulaire -->
          <div class="fv-row row mb-6">
            <div class="col-6">
              <input type="text" class="form-control bg-transparent" placeholder="Prénom" formControlName="firstName"
                [ngClass]="getControlClass('firstName')" />
              <ng-container [ngTemplateOutlet]="formError" [ngTemplateOutletContext]="{
          validation: 'required',
          message: 'Prénom est obligatoire',
          control: registrationForm.controls['firstName']
        }"></ng-container>
            </div>
            <div class="col-6 ">
              <input type="text" class="form-control bg-transparent" placeholder="Nom" formControlName="lastName"
                [ngClass]="getControlClass('lastName')" />
              <ng-container [ngTemplateOutlet]="formError" [ngTemplateOutletContext]="{
          validation: 'required',
          message: 'Nom est obligatoire',
          control: registrationForm.controls['lastName']
        }"></ng-container>
            </div>
          </div>

          <div class="fv-row mb-6">
            <input type="email" class="form-control bg-transparent" placeholder="Email" formControlName="email"
              [ngClass]="getControlClass('email')" />
            <ng-container [ngTemplateOutlet]="formError" [ngTemplateOutletContext]="{
        validation: 'required',
        message: 'Email est obligatoire',
        control: registrationForm.controls['email']
      }"></ng-container>
            <ng-container [ngTemplateOutlet]="formError" [ngTemplateOutletContext]="{
        validation: 'email',
        message: 'Email est invalide',
        control: registrationForm.controls['email']
      }"></ng-container>
            <ng-container [ngTemplateOutlet]="formError" [ngTemplateOutletContext]="{
        validation: 'minlength',
        message: 'Email doit contenir au moins 3 caractères',
        control: registrationForm.controls['email']
      }"></ng-container>
            <ng-container [ngTemplateOutlet]="formError" [ngTemplateOutletContext]="{
        validation: 'maxLength',
        message: 'Email doit contenir au maximum 360 caractères',
        control: registrationForm.controls['email']
      }"></ng-container>
          </div>

          <div class="fv-row mb-6">
            <input type="password" class="form-control bg-transparent" placeholder="Mot de passe"
              formControlName="password" [ngClass]="getControlClass('password')" />
            <div class="mt-2">
              <password-strength-meter [password]="registrationForm.get('password')?.value" [minPasswordLength]="6"
                [numberOfProgressBarItems]="4" [colors]="['#e74c3c', '#f39c12', '#f1c40f', '#2ecc71']"
                [enableFeedback]="false">
              </password-strength-meter>
              <!-- Message d'erreur s’il y a -->
              <ng-container [ngTemplateOutlet]="formError" [ngTemplateOutletContext]="{
        validation: 'required',
        message: 'Mot de passe est obligatoire',
        control: registrationForm.controls['password']
      }"></ng-container>

              <ng-container [ngTemplateOutlet]="formError" [ngTemplateOutletContext]="{
    validation: 'minlength',
    message: 'Le mot de passe doit faire au moins 6 caractères',
    control: registrationForm.controls['password']
  }"></ng-container>

              <!-- Erreur 'maxlength' -->
              <ng-container [ngTemplateOutlet]="formError" [ngTemplateOutletContext]="{
    validation: 'maxlength',
    message: 'Le mot de passe ne peut pas dépasser 100 caractères',
    control: registrationForm.controls['password']
  }"></ng-container>
            </div>

          </div>

          <div class="fv-row mb-6">
            <input type="password" class="form-control bg-transparent" placeholder="Confirmer le mot de passe"
              formControlName="cPassword" [ngClass]="getControlClass('cPassword')" />
            <ng-container [ngTemplateOutlet]="formError" [ngTemplateOutletContext]="{
        validation: 'required',
        message: 'Confirm Password is required',
        control: registrationForm.controls['cPassword']
      }"></ng-container>
            <ng-container *ngIf="
        registrationForm.controls['cPassword'].errors &&
        registrationForm.controls['cPassword'].errors?.['ConfirmPassword']
      ">
              <div class="fv-plugins-message-container">
                <div class="fv-help-block">
                  <span role="alert">
                    Les mots de passe ne correspondent pas
                  </span>
                </div>
              </div>
            </ng-container>
          </div>

          <!-- Bouton d'envoi -->
          <div class="d-grid mb-6">
            <button type="submit" id="kt_sign_up_submit" class="btn btn-primary">
              S'inscrire
            </button>
          </div>

          <!-- Lien vers connexion -->
          <div class="text-center text-gray-500 fw-semibold fs-6 mb-6">
            Vous avez déjà un compte ?
            <a routerLink="/auth/login" class="link-primary fw-semibold cursor-pointer"> Se connecter </a>
          </div>

        </form>
      </div>
    </div>

  </div>
</div>




<ng-template #formError let-control="control" let-message="message" let-validation="validation">
  <ng-container *ngIf="control.hasError(validation) && (control.dirty || control.touched)">
    <div class="fv-plugins-message-container">
      <div class="fv-help-block">
        <span role="alert">
          {{ message }}
        </span>
      </div>
    </div>
  </ng-container>
</ng-template>
