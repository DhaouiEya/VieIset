<div class="min-h-screen bg-gray-50 pt-6 pl-6 pr-6">
  <div class="header-strip ">
    <h4> Liste des réclamations</h4>
  </div>
  <div class="table-container ">
    <div class="table-responsive">
      <table class="table table-bordered table-hover table-striped">
        <thead class="thead-dark">
          <tr>
            <th>Étudiant</th>
            <th>Email</th>
            <th>Sujet</th>
            <th>Description</th>
            <th>Statut</th>
            <th>Date de création</th>
          </tr>
        </thead>
        <tbody>
          @for (r of reclamations; track $index) {
            <tr>
              <td>{{ r.etudiant?.lastName || '' }} {{ r.etudiant?.firstName || '' }}</td>
              <td>{{ r.etudiant?.email || '' }}</td>

              <!-- Sujet avec modal -->
              <td>
                @if(r.sujet.length > 30) {
                  {{ r.sujet | slice:0:30 }}...
                  <a href="#" (click)="openSujet(modalSujet, r.sujet); $event.preventDefault()">Voir plus</a>
                } @else {
                  {{ r.sujet }}
                }
              </td>

              <!-- Description avec modal -->
              <td>
                @if(r.description.length > 50) {
                  {{ r.description | slice:0:50 }}...
                  <a href="#" (click)="openDescription(modalDesc, r.description); $event.preventDefault()">Voir plus</a>
                } @else {
                  {{ r.description }}
                }
              </td>

              <td>
                <span class="badge" [ngClass]="{
                  'bg-secondary': r.statut==='Nouvelle',
                  'bg-info text-dark': r.statut==='En cours',
                  'bg-success': r.statut==='Résolue',
                  'bg-danger': r.statut==='Rejetée'
                }">
                  {{ r.statut }}
                </span>
              </td>
              <td>{{ r.dateCreation | date:'short' }}</td>
            </tr>
          }
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- Modal Description très simple et centrée -->
<ng-template #modalDesc let-modal>
  <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
    <div class="modal-content border-0 shadow-none">
      <!-- Corps de la modal -->
      <div class="modal-body p-3 text-center">
        <p class="mb-0">{{ descriptionToShow }}</p>
      </div>
    </div>
  </div>
</ng-template>

<!-- Modal Sujet -->
<ng-template #modalSujet let-modal>
  <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
    <div class="modal-content border-0 shadow-none">
      <div class="modal-body p-3 text-center">
        <p>{{ sujetToShow }}</p>
      </div>
    </div>
  </div>
</ng-template>
